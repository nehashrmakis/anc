import{r as l,j as e,$ as q,M as h}from"./app-hkHtsVWY.js";import D from"./Header-B2u-Ke0U.js";import O from"./Sidebar-2qtfisrx.js";import"./Dropdown-DJHpTJ5L.js";import"./transition-BTqLGtpx.js";function z(){const[x,N]=l.useState([]),[u,r]=l.useState({}),[g,v]=l.useState(""),[c,y]=l.useState(1),j=10,[n,b]=l.useState({id:"",name:"",email:"",contact_number:"",location:""}),[R,E]=l.useState(!1),[L,_]=l.useState("Add Supplier"),S=c*j,P=S-j;x.slice(P,S);const p=Math.ceil(x.length/j),k=()=>{const a=document.getElementById("add-agent-modal-more");if(!a)return;let t=h.getInstance(a);t||(t=new h(a)),t.hide(),document.querySelectorAll(".modal-backdrop").forEach(s=>s.remove()),document.body.classList.remove("modal-open"),document.body.style=""},d=a=>{const{name:t,value:s}=a.target;b(i=>({...i,[t]:s})),u&&r("")},A=()=>{const{name:a,email:t,contact_number:s,location:i}=n;return a.trim()?t.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?s.trim()?i.trim()?!0:(r("Location is required."),!1):(r("Contact Number is required."),!1):(r("Please enter a valid email address."),!1):(r("Email is required."),!1):(r("Supplier Name is required."),!1)},I=async a=>{if(a.preventDefault(),!!A())try{const t=!!n.id,s=t?`/api/suppliers/${n.id}`:"/api/addsupplier",o=await fetch(s,{method:t?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(o.ok)k(),v(t?"Supplier updated successfully!":"Supplier added successfully!"),b({id:"",name:"",email:"",contact_number:"",location:""}),w();else{const F=await o.json();r(F.message||"Unknown error")}}catch(t){console.error("Error:",t),r(t.message||"An error occurred while submitting the form.")}},T=async a=>{try{const s=await(await fetch(`/api/suppliers/${a}/edit`)).json();b({id:s.supplier.id,name:s.supplier.name,email:s.supplier.email,contact_number:s.supplier.contact_number,location:s.supplier.location}),E(!0),_("Edit Supplier");const i=document.getElementById("add-agent-modal-more");let o=h.getInstance(i);o||(o=new h(i)),o.show()}catch(t){console.error("Error fetching supplier data:",t)}},w=async()=>{try{const t=await(await fetch("/api/showsuppdata")).json();N(t.suppliers||[]),y(1)}catch(a){console.error("Failed to fetch suppliers:",a),N([])}},f=a=>{a<1||a>p||y(a)};l.useEffect(()=>{w()},[]),l.useEffect(()=>{setTimeout(()=>{v("")},5e3)},[g]);const[m,M]=l.useState("");let $=a=>{var t=a.target.value.toLowerCase();M(t),console.log("Input Text:",t)};const C=x.filter(a=>m===""?a:a.name.toLowerCase().includes(m)||a.location.toLowerCase().includes(m)||a.contact_number.toLowerCase().includes(m)||a.email.toLowerCase().includes(m));return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Agent Listing"}),e.jsx(D,{}),e.jsx(O,{}),e.jsxs("main",{className:"app-content p-lg-5 product-invoice",children:[e.jsxs("div",{className:"new-invoice suplier-searchbar mt-4 mt-lg-4 d-flex align-items-start align-items-md-center align-items-md-center gap-2 gap-lg-5 flex-column flex-md-row flex-lg-row",children:[e.jsx("div",{className:"invoice-btn",children:e.jsx("a",{href:"#",className:"common_btn","data-bs-toggle":"modal","data-bs-target":"#add-agent-modal-more",children:"Add Supplier"})}),e.jsx("div",{className:"header-search suplier-location mt-3 mt-lg-0 mt-md-0",children:e.jsxs("div",{className:"input-group rounded-3",children:[e.jsx("input",{type:"text",className:"form-control border-0 ps-3",placeholder:"Suppliers Location","aria-label":"Suppliers Location","aria-describedby":"search-bar",id:"outlined-basic",onChange:$}),e.jsx("span",{className:"input-group-text border-0 rounded-3 pe-3",id:"search-bar",children:e.jsx("i",{className:"fa fa-location-arrow"})})]})})]}),e.jsxs("div",{className:"product-list-table suplier-list-table mt-3 mt-lg-5",children:[g&&e.jsx("div",{className:"alert alert-success",children:g}),e.jsxs("table",{className:"mb-3",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Supplier Name"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Contact Number"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:C.length>0?C.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:a.name}),e.jsx("td",{children:e.jsx("span",{className:"color-golden",children:a.location})}),e.jsx("td",{children:a.contact_number}),e.jsx("td",{children:a.email}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-primary edit_btn",onClick:()=>T(a.id),"data-bs-toggle":"modal","data-bs-target":"#add-agent-modal-more",children:"Edit"})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center",children:"No suppliers found."})})})]})]}),p>1&&e.jsx("nav",{"aria-label":"Page navigation example",children:e.jsxs("ul",{className:"pagination justify-content-center",children:[e.jsx("li",{className:`page-item ${c===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>f(c-1),children:e.jsx("i",{class:"fa-solid fa-angle-left"})})}),[...Array(p)].map((a,t)=>e.jsx("li",{className:`page-item ${c===t+1?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>f(t+1),children:t+1})},t)),e.jsx("li",{className:`page-item ${c===p?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>f(c+1),children:e.jsx("i",{class:"fa-solid fa-angle-right"})})})]})})]}),e.jsx("div",{className:"modal fade",id:"add-agent-modal-more",tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered",children:e.jsxs("div",{className:"modal-content p-3 p-lg-4 rounded-4 border-0",children:[e.jsxs("div",{className:"modal-header border-bottom-0 p-0",children:[e.jsx("h2",{className:"modal-title",children:L}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body p-0",children:e.jsx(e.Fragment,{children:e.jsxs("form",{className:"row p-3",onSubmit:I,children:[u&&typeof u=="string"&&e.jsx("div",{className:"alert alert-danger",children:u}),e.jsx("input",{type:"hidden",name:"id",value:n.id||"",onChange:d}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"form-label",children:"Supplier Name"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Supplier Name",name:"name",value:n.name,onChange:d})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",placeholder:"Email",name:"email",value:n.email,onChange:d})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Phone",name:"contact_number",value:n.contact_number,onChange:d})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Location"}),e.jsx("textarea",{className:"form-control",placeholder:"Location",name:"location",value:n.location,onChange:d})]}),e.jsx("div",{className:"col-12 text-center",children:e.jsx("input",{type:"submit",className:"common_btn",value:"Submit"})})]})})})]})})})]})}export{z as default};
