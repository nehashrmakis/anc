import{r as g,q,v as A,j as e,$ as E,m as T}from"./app-DKcAQ6_-.js";import D from"./Header-BRF3mAJO.js";import B from"./Sidebar-BKfS1058.js";import"./Dropdown-CQjxdwPE.js";import"./transition-D9AalLht.js";function R({inventory:b,ports:y,suppliers:w,invoice:a=null}){var f;const x=!!a,[C]=g.useState(y||[]),{errors:d}=q().props,{data:i,setData:o}=A({invoice_no:(a==null?void 0:a.invoice_no)||"",po_number:(a==null?void 0:a.po_number)||"",supplier:(a==null?void 0:a.supplier)||"",arrival_depo:(a==null?void 0:a.arrival_depo)||"",on_transit:(a==null?void 0:a.on_transit)||"",landing_date:(a==null?void 0:a.landing_date)||"",containers:((f=a==null?void 0:a.containers)==null?void 0:f.length)>0?a.containers.map(s=>({id:s.container_id||"",products:s.products.map(l=>({inventory_id:l.inventory_id||"",marking:l.marking||"",size:l.size||"",size_unit:l.size_unit||"",weight:l.weight||"",weight_unit:l.weight_unit||"",total_bundles:l.total_bundles||"",quantity_per_bundle:l.quantity_per_bundle||"",total_product:l.total_product||""}))})):[{id:"",products:[{inventory_id:"",marking:"",size:"",size_unit:"",weight:"",weight_unit:"",total_bundles:"",quantity_per_bundle:"",total_product:""}]}]}),[v,$]=g.useState(i.containers.length),[p,N]=g.useState(0),z=s=>{const l=parseInt(s.target.value,10)||0;$(l);const n=[...i.containers];for(;n.length<l;)n.push({id:"",products:[{inventory_id:"",marking:"",size:"",size_unit:"",weight:"",weight_unit:"",total_bundles:"",quantity_per_bundle:"",total_product:""}]});o("containers",n.slice(0,l)),p>=l&&N(0)},h=(s,l,n,t)=>{const r=[...i.containers],c=r[s].products[l];if(c[n]=t,n==="inventory_id"){const u=b.find(j=>j.id===parseInt(t));u?(c.size=u.size||"",c.size_unit=u.size_unit||"",c.weight=u.weight||"",c.weight_unit=u.weight_unit||""):(c.size="",c.size_unit="",c.weight="",c.weight_unit="")}if(n==="total_bundles"||n==="quantity_per_bundle"){const u=parseFloat(c.total_bundles)||0,j=parseFloat(c.quantity_per_bundle)||0;c.total_product=u*j}o("containers",r)},k=s=>{const l=[...i.containers];l[s].products.push({inventory_id:"",marking:"",size:"",size_unit:"",weight:"",weight_unit:"",total_bundles:"",quantity_per_bundle:"",total_product:"",isNew:!0}),o("containers",l)},P=(s,l)=>{const n=[...i.containers];n[s].products.splice(l,1),o("containers",n)},_=s=>{s.preventDefault();const l=x?"invoice.update":"invoice.store";T[x?"put":"post"](route(l,a==null?void 0:a.id),{invoice_no:i.invoice_no,po_number:i.po_number,supplier:i.supplier,arrival_depo:i.arrival_depo,on_transit:i.on_transit,landing_date:i.landing_date,containers:i.containers})},S=s=>d&&Object.prototype.hasOwnProperty.call(d,s),m=s=>S(s)?"is-invalid":"";return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:a?"Edit Invoice":"Add Invoice"}),e.jsx(D,{}),e.jsx(B,{}),e.jsx("main",{className:"app-content p-lg-5 add-invoice",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-8 col-lg-8 col-xl-7",children:e.jsxs("div",{className:"add-invoice-left",children:[e.jsxs("div",{className:"invoice-form px-4 py-4 rounded-4 mt-lg-3",children:[e.jsx("h2",{className:"common-heading pb-2",children:"Invoice"}),e.jsx("form",{className:"mt-3",onSubmit:_,children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-xl-3 mb-1",children:[e.jsx("label",{className:"form-label mb-0",children:"Invoice No."}),e.jsx("input",{type:"text",className:`form-control rounded-5 ${d.invoice_no?"is-invalid":""}`,placeholder:"123465787",value:i.invoice_no,onChange:s=>o("invoice_no",s.target.value)})]}),e.jsxs("div",{className:"col-xl-3 mb-1",children:[e.jsx("label",{className:"form-label mb-0",children:"Container"}),e.jsx("input",{type:"number",className:"form-control rounded-5",value:v,onChange:z,min:1,max:10})]}),e.jsxs("div",{className:"col-xl-3 mb-1",children:[e.jsx("label",{className:"form-label mb-0",children:"PO Number"}),e.jsx("input",{type:"text",className:`form-control rounded-5 ${d.po_number?"is-invalid":""}`,value:i.po_number,onChange:s=>o("po_number",s.target.value)})]}),e.jsxs("div",{className:"col-xl-3 mb-1",children:[e.jsx("label",{className:"form-label mb-0",children:"Supplier"}),e.jsxs("select",{className:`form-select rounded-5 ${d.supplier?"is-invalid":""}`,value:i.supplier,onChange:s=>o("supplier",s.target.value),children:[e.jsx("option",{value:"",children:"Select "}),w.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})]})]})})]}),e.jsxs("div",{className:"invoice-product mt-3 mb-3",children:[e.jsx("ul",{className:"ms-3 nav nav-tabs gap-2 border-0",role:"tablist",children:Array.from({length:v}).map((s,l)=>e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:`nav-link py-2 ${p===l?"active":""}`,type:"button",onClick:()=>N(l),children:["Container ",l+1]})},l))}),e.jsx("div",{className:"tab-content invoice-prod-cont rounded-4 mt-3",children:i.containers.map((s,l)=>e.jsx("div",{className:`tab-pane fade ${p===l?"show active":""}`,role:"tabpanel",children:e.jsx("div",{className:"invoice-product-form",children:e.jsxs("form",{className:"px-3 px-lg-4 py-4 px-md-4",children:[e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"d-block d-md-flex d-lg-flex align-items-center gap-2",children:[e.jsx("label",{className:"form-label",children:"Container ID  "}),e.jsx("div",{className:"rounded-5",children:e.jsx("input",{type:"text",className:`form-control ${m(`containers.${l}.id`)}`,value:s.id,onChange:n=>{const t=[...i.containers];t[l].id=n.target.value,o("containers",t)}})})]})})}),s.products.map((n,t)=>e.jsxs("div",{className:"invoice-product-append mb-4 pb-4",children:[n.isNew&&e.jsx("div",{className:"remove-product text-end mb-3",children:e.jsxs("button",{type:"button",className:"remove-btn rounded-2 border-0",onClick:()=>P(l,t),children:[e.jsx("span",{className:"me-1",children:"âœ•"}),"Remove"]})}),e.jsxs("div",{className:"row gy-2 gy-lg-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"d-block d-md-flex d-lg-flex align-items-center gap-2",children:[e.jsx("label",{className:"form-label mb-0",children:"Product Name"}),e.jsxs("select",{className:`form-select ${m(`containers.${l}.products.${t}.inventory_id`)}`,value:n.inventory_id,onChange:r=>h(l,t,"inventory_id",r.target.value),children:[e.jsx("option",{value:"",children:"Select a Product"}),b.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]})}),e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"d-block d-md-flex d-lg-flex align-items-center gap-2",children:[e.jsx("label",{className:"form-label mb-0 me-3",children:"ANC Marking"}),e.jsx("div",{className:"d-flex gap-3",children:["Yes","No"].map(r=>e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:`form-check-input ${m(`containers.${l}.products.${t}.marking`)}`,type:"radio",name:`marking-${l}-${t}`,value:r,checked:n.marking===r,onChange:c=>h(l,t,"marking",c.target.value)}),e.jsx("label",{className:"form-check-label",children:r})]},r))})]})}),e.jsx("div",{className:"col-sm-6 col-md-6 col-lg-6",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("label",{className:"form-label mb-0 text-end",children:"Size"}),e.jsx("div",{className:"rounded-5",children:e.jsx("input",{type:"text",className:`form-control color-grey ${m(`containers.${l}.products.${t}.size`)}`,value:n.size,onChange:r=>h(l,t,"size",r.target.value),disabled:!0})}),e.jsxs("span",{children:["(",n.size_unit||"feet",")"]})]})}),e.jsx("div",{className:"col-sm-6 col-md-6 col-lg-6",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("label",{className:"form-label mb-0 text-end",children:"Weight"}),e.jsx("div",{className:"rounded-5",children:e.jsx("input",{type:"text",className:`form-control color-grey ${m(`containers.${l}.products.${t}.weight`)}`,value:n.weight,onChange:r=>h(l,t,"weight",r.target.value),disabled:!0})}),e.jsxs("span",{children:["(",n.weight_unit||"kg",")"]})]})}),e.jsx("div",{className:"col-sm-6 col-md-6 col-lg-6",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsxs("label",{className:"form-label mb-0 text-end",children:["Total Bundles",e.jsx("br",{}),e.jsx("sub",{children:"(A)"})]}),e.jsx("div",{className:"rounded-5",children:e.jsx("input",{type:"number",className:`form-control ${m(`containers.${l}.products.${t}.total_bundles`)}`,value:n.total_bundles,onChange:r=>h(l,t,"total_bundles",r.target.value)})})]})}),e.jsx("div",{className:"col-sm-6 col-md-6 col-lg-6",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsxs("label",{className:"form-label mb-0 float-lg-end text-end",children:["Qt. Per Bundles",e.jsx("br",{}),e.jsx("sub",{children:"(B)"})]}),e.jsx("input",{type:"number",className:`form-control ${m(`containers.${l}.products.${t}.quantity_per_bundle`)}`,value:n.quantity_per_bundle,onChange:r=>h(l,t,"quantity_per_bundle",r.target.value)})]})}),e.jsx("div",{className:"col-md-7 col-lg-7",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsxs("label",{className:"form-label mb-0 float-lg-end text-end",children:["Total Product",e.jsx("br",{}),e.jsx("sub",{children:"(A X B)"})]}),e.jsx("div",{className:"input-group rounded-5",children:e.jsx("input",{type:"number",className:"form-control color-grey",readOnly:!0,value:n.total_product})})]})})]})]},t)),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",className:"common_btn border-0",onClick:()=>k(l),children:"Add More Product"})})]})})},l))})]}),e.jsxs("div",{className:"prod-transit-form px-3 px-lg-4 px-xxl-5 px-md-4 py-4 rounded-4 d-flex flex-column justify-content-between mt-lg-3",children:[e.jsx("h2",{className:"common-heading",children:"Transit  Info"}),e.jsx("form",{className:"mt-3",children:e.jsxs("div",{className:"row gy-2 gy-lg-2",children:[e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-4 col-lg-4 col-xl-3 col-xxl-3",children:e.jsx("label",{className:"form-label mb-0",children:"Arrival Port"})}),e.jsx("div",{className:"col-md-8 col-lg-8 col-xl-9 col-xxl-9",children:e.jsxs("select",{className:`form-select ${d.arrival_depo?"is-invalid":""}`,value:i.arrival_depo,onChange:s=>o("arrival_depo",s.target.value),children:[e.jsx("option",{value:"",children:"Select Port"}),C.map(s=>e.jsxs("option",{value:s.name,children:[s.name," - ",s.location]}))]})})]})}),e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-4 col-lg-4 col-xl-3 col-xxl-3",children:e.jsx("label",{className:"form-label mb-0",children:"On Transit"})}),e.jsx("div",{className:"col-md-8 col-lg-8 col-xl-9 col-xxl-9",children:e.jsxs("select",{className:`form-select ${d.on_transit?"is-invalid":""}`,value:i.on_transit,onChange:s=>o("on_transit",s.target.value),children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"In water",children:"In water"}),e.jsx("option",{value:"1",children:"On Hold"}),e.jsx("option",{value:"2",children:"Out for Delivery"}),e.jsx("option",{value:"3",children:"Delayed"})]})})]})}),e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-4 col-lg-4 col-xl-3 col-xxl-3",children:e.jsx("label",{className:"form-label mb-0",children:"Landing date"})}),e.jsx("div",{className:"col-md-8 col-lg-8 col-xl-9 col-xxl-9",children:e.jsx("input",{type:"date",className:`form-control ${d.landing_date?"is-invalid":""}`,value:i.landing_date,onChange:s=>o("landing_date",s.target.value)})})]})})]})})]})]})}),e.jsx("div",{className:"col-md-4 col-lg-4 col-xl-5",children:e.jsxs("div",{className:"add-invoice-right pt-4 pt-lg-5 d-flex justify-content-center gap-2",children:[e.jsx("a",{href:"/invoices",className:"add-invo-arrow",children:e.jsx("i",{className:"fa-solid fa-arrow-left"})}),e.jsxs("div",{className:"add-invo-btn text-center",children:[e.jsx("button",{type:"button",className:"common_btn border-0",onClick:_,children:x?"Update Invoice":"Add Invoice"}),e.jsx("p",{className:"instrcution-error mt-3",children:"All fields are mandatory"})]})]})})]})})]})}export{R as default};
