import{r as c,j as e,$ as C,R as M,m as p}from"./app-DKcAQ6_-.js";import q from"./Header-BRF3mAJO.js";import z from"./Sidebar-BKfS1058.js";import{S as u}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./Dropdown-CQjxdwPE.js";import"./transition-D9AalLht.js";function T({category:d,inventory:l,title:A,final_inventory_count:j,mainPort:n}){const[h,m]=c.useState({}),[i,f]=c.useState("all"),[o,g]=c.useState("all"),N=(s,a)=>{m(t=>{const r=t[s]||1;return r<(a??1/0)?{...t,[s]:r+1}:t})},_=s=>{m(a=>({...a,[s]:Math.max((a[s]||1)-1,1)}))},v=s=>{p.post(route("cart.store"),{id:s.inventory_id,invoice_id:s.invoice_id,name:s.name,size:s.size,size_unit:s.size_unit,weight:s.weight,weight_unit:s.weight_unit,arrival_depo:s.arrival_depo,quantity:h[s.final_inventory_id]||1})},b=s=>{u.fire({title:"Send to Main Port",html:`
      <input id="main-port" type="text" class="swal2-input" value="${(n==null?void 0:n.name)||""}" readonly />
      <input id="main-port-id" type="hidden" value="${(n==null?void 0:n.id)||""}" />
      <input id="quantity" type="number" class="swal2-input" placeholder="Quantity" min="1" />
    `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Send & Sync",preConfirm:()=>{const a=document.getElementById("main-port-id").value,t=Number(document.getElementById("quantity").value);return!a||!t||t<=0?(u.showValidationMessage("Please enter a valid quantity"),!1):{port:a,quantity:t}}}).then(a=>{if(a.isConfirmed){const{port:t,quantity:r}=a.value;p.post(route("inventory.sendToMainPort"),{final_inventory_id:s,port:t,quantity:r},{preserveScroll:!0,preserveState:!0,onSuccess:()=>u.fire("Success","Inventory sent and synced to QuickBooks","success"),onError:()=>u.fire("Error","Something went wrong.","error")})}})},x=c.useMemo(()=>((l==null?void 0:l.data)??[]).filter(a=>{const t=i==="all"||a.inventory_id===Number(i),r=o==="all"||a.arrival_depo===o;return t&&r}),[l,i,o]),S=c.useMemo(()=>x.reduce((s,a)=>{const t=(a.invoice_id??`no-invoice-${a.final_inventory_id}`).toString();return s[t]||(s[t]=[]),s[t].push(a),s},{}),[x]),w=c.useMemo(()=>Array.from(new Set(((l==null?void 0:l.data)??[]).map(a=>a.inventory_id))).map(a=>{const t=((l==null?void 0:l.data)??[]).find(r=>r.inventory_id===a);return{id:a,name:(t==null?void 0:t.name)||`Product ${a}`}}),[l]),y=c.useMemo(()=>Array.from(new Set(((l==null?void 0:l.data)??[]).map(s=>s.arrival_depo))).filter(Boolean),[l]);return e.jsxs(e.Fragment,{children:[e.jsx(C,{title:"Product List"}),e.jsx(q,{}),e.jsx(z,{}),e.jsxs("main",{className:"app-content p-lg-5 product-list",children:[e.jsx("div",{className:"scaffolding-tubes mt-3 mt-lg-5",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-12 col-lg-5 col-xl-5 col-xxl-6",children:e.jsxs("div",{className:"prod-thumb d-flex align-items-start gap-3",children:[e.jsx("div",{className:"prod-thumb-img",children:e.jsx("img",{src:d.image?`/uploads/${d.image}`:"/assets/img/icons/upload-file.png",alt:d.name,className:"rounded-3"})}),e.jsxs("div",{className:"prod-thumb-text",children:[e.jsx("h4",{children:d.name}),e.jsxs("p",{className:"mt-1",children:["Total Products : ",j]})]})]})}),e.jsx("div",{className:"col-md-12 col-lg-7 col-xl-7 col-xxl-6",children:e.jsx("div",{className:"prod-and-depo ms-auto mt-3 mt-lg-0",children:e.jsx("div",{className:"row justify-content-end",children:e.jsx("div",{className:"col-md-8 col-lg-8",children:e.jsxs("div",{className:"pod-all d-flex gap-2",children:[e.jsx("button",{className:"border-0 common_btn",children:e.jsx("i",{className:"ri-equalizer-fill"})}),e.jsxs("select",{className:"form-select",value:i,onChange:s=>f(s.target.value),children:[e.jsx("option",{value:"all",children:"All Products"}),w.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("select",{className:"form-select",value:o,onChange:s=>g(s.target.value),children:[e.jsx("option",{value:"all",children:"All Depo"}),y.map((s,a)=>e.jsx("option",{value:s,children:s},a))]})]})})})})})]})}),e.jsx("div",{className:"product-list-table mt-3 mt-lg-5",children:e.jsxs("table",{className:"mb-3",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Products name"}),e.jsx("th",{children:"Supplier Name"}),e.jsx("th",{children:"Size"}),e.jsx("th",{className:"text-center",children:"Weight"}),e.jsx("th",{className:"text-center",children:"Quantity"}),e.jsx("th",{className:"text-center",children:"Agent / Depo"}),e.jsx("th",{className:"text-center",children:"Transit"}),e.jsx("th",{colSpan:"2",children:"Add to Cart"})]})}),e.jsx("tbody",{children:Object.entries(S).map(([s,a])=>e.jsxs(M.Fragment,{children:[e.jsx("tr",{className:"table-secondary",children:e.jsxs("td",{colSpan:"9",className:"fw-bold",children:["Invoice ID: ",s]})}),a.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.name}),e.jsx("td",{children:t.supplier}),e.jsxs("td",{children:[t.size," ",t.size_unit]}),e.jsxs("td",{className:"text-center",children:[t.weight," ",t.weight_unit]}),e.jsx("td",{className:"text-center",children:t.total_product}),e.jsx("td",{className:"text-center",children:t.arrival_depo}),e.jsx("td",{className:"text-center",children:t.on_transit}),e.jsx("td",{colSpan:"2",children:e.jsxs("div",{className:"cart-counting d-flex gap-2",children:[e.jsxs("div",{className:"cart-counting-inc d-flex gap-2 align-items-center",children:[e.jsx("button",{onClick:()=>_(t.final_inventory_id),className:"border-0",children:"-"}),e.jsx("p",{className:"counting",children:h[t.final_inventory_id]||1}),e.jsx("button",{onClick:()=>N(t.final_inventory_id,t.total_product),className:"border-0",children:"+"})]}),e.jsx("div",{className:"cart-counting-btn",children:e.jsx("button",{onClick:()=>v(t),className:"rounded-2 border-0 common_btn",children:"Add to cart"})})]})}),e.jsx("td",{children:e.jsx("div",{className:"action-btn d-flex gap-2",children:t.arrival_depo===(n==null?void 0:n.name)?e.jsx("span",{className:"badge-main-port",children:"In Main Port"}):e.jsx("button",{onClick:()=>b(t.final_inventory_id),className:"border-0 text-success",title:"Send to Main Port",children:e.jsx("i",{className:"fa-solid fa-arrow-right-arrow-left"})})})})]},t.final_inventory_id))]},s))})]})})]})]})}export{T as default};
