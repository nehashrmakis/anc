import{r as c,j as e,$ as B,R as M,m as h}from"./app-hkHtsVWY.js";import A from"./Header-B2u-Ke0U.js";import k from"./Sidebar-2qtfisrx.js";import{S as d}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./Dropdown-DJHpTJ5L.js";import"./transition-BTqLGtpx.js";function Q({category:i,inventory:n,title:q,final_inventory_count:j,mainPort:l}){const[m,x]=c.useState({}),[o,f]=c.useState("all"),[u,g]=c.useState("all"),N=(t,a)=>{x(s=>{const r=s[t]||1;return r<(a??1/0)?{...s,[t]:r+1}:s})},_=t=>{x(a=>({...a,[t]:Math.max((a[t]||1)-1,1)}))},v=t=>{h.post(route("cart.store"),{id:t.inventory_id,invoice_id:t.invoice_id,name:t.name,size:t.size,size_unit:t.size_unit,weight:t.weight,weight_unit:t.weight_unit,arrival_depo:t.arrival_depo,quantity:m[t.final_inventory_id]||1})},b=t=>{d.fire({title:"Are you sure?",text:"This item will be permanently deleted from inventory.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(a=>{a.isConfirmed&&h.delete(route("categories.destroyinventory",{category:i.id,id:t}),{preserveScroll:!0,preserveState:!0})})},S=t=>{d.fire({title:"Send to Main Port",html:`
      <input id="main-port" type="text" class="swal2-input" value="${(l==null?void 0:l.name)||""}" readonly />
      <input id="main-port-id" type="hidden" value="${(l==null?void 0:l.id)||""}" />
      <input id="quantity" type="number" class="swal2-input" placeholder="Quantity" min="1" />
    `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Send & Sync",preConfirm:()=>{const a=document.getElementById("main-port-id").value,s=Number(document.getElementById("quantity").value);return!a||!s||s<=0?(d.showValidationMessage("Please enter a valid quantity"),!1):{port:a,quantity:s}}}).then(a=>{if(a.isConfirmed){const{port:s,quantity:r}=a.value;h.post(route("inventory.sendToMainPort"),{final_inventory_id:t,port:s,quantity:r},{preserveScroll:!0,preserveState:!0,onSuccess:()=>d.fire("Success","Inventory sent and synced to QuickBooks","success"),onError:()=>d.fire("Error","Something went wrong.","error")})}})},p=c.useMemo(()=>((n==null?void 0:n.data)??[]).filter(a=>{const s=o==="all"||a.inventory_id===Number(o),r=u==="all"||a.arrival_depo===u;return s&&r}),[n,o,u]),w=c.useMemo(()=>p.reduce((t,a)=>{const s=(a.invoice_id??`no-invoice-${a.final_inventory_id}`).toString();return t[s]||(t[s]=[]),t[s].push(a),t},{}),[p]),y=c.useMemo(()=>Array.from(new Set(((n==null?void 0:n.data)??[]).map(a=>a.inventory_id))).map(a=>{const s=((n==null?void 0:n.data)??[]).find(r=>r.inventory_id===a);return{id:a,name:(s==null?void 0:s.name)||`Product ${a}`}}),[n]),C=c.useMemo(()=>Array.from(new Set(((n==null?void 0:n.data)??[]).map(t=>t.arrival_depo))).filter(Boolean),[n]);return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Product List"}),e.jsx(A,{}),e.jsx(k,{}),e.jsxs("main",{className:"app-content p-lg-5 product-list",children:[e.jsx("div",{className:"scaffolding-tubes mt-3 mt-lg-5",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-12 col-lg-5 col-xl-5 col-xxl-6",children:e.jsxs("div",{className:"prod-thumb d-flex align-items-start gap-3",children:[e.jsx("div",{className:"prod-thumb-img",children:e.jsx("img",{src:i.image?`/uploads/${i.image}`:"/assets/img/icons/upload-file.png",alt:i.name,className:"rounded-3"})}),e.jsxs("div",{className:"prod-thumb-text",children:[e.jsx("h4",{children:i.name}),e.jsxs("p",{className:"mt-1",children:["Total Products : ",j]})]})]})}),e.jsx("div",{className:"col-md-12 col-lg-7 col-xl-7 col-xxl-6",children:e.jsx("div",{className:"prod-and-depo ms-auto mt-3 mt-lg-0",children:e.jsx("div",{className:"row justify-content-end",children:e.jsx("div",{className:"col-md-8 col-lg-8",children:e.jsxs("div",{className:"pod-all d-flex gap-2",children:[e.jsx("button",{className:"border-0 common_btn",children:e.jsx("i",{className:"ri-equalizer-fill"})}),e.jsxs("select",{className:"form-select",value:o,onChange:t=>f(t.target.value),children:[e.jsx("option",{value:"all",children:"All Products"}),y.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{className:"form-select",value:u,onChange:t=>g(t.target.value),children:[e.jsx("option",{value:"all",children:"All Depo"}),C.map((t,a)=>e.jsx("option",{value:t,children:t},a))]})]})})})})})]})}),e.jsx("div",{className:"product-list-table mt-3 mt-lg-5",children:e.jsxs("table",{className:"mb-3",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Products name"}),e.jsx("th",{children:"Supplier Name"}),e.jsx("th",{children:"Size"}),e.jsx("th",{className:"text-center",children:"Weight"}),e.jsx("th",{className:"text-center",children:"Quantity"}),e.jsx("th",{className:"text-center",children:"Agent / Depo"}),e.jsx("th",{className:"text-center",children:"Transit"}),e.jsx("th",{colSpan:"2",children:"Add to Cart"})]})}),e.jsx("tbody",{children:Object.entries(w).map(([t,a])=>e.jsxs(M.Fragment,{children:[e.jsx("tr",{className:"table-secondary",children:e.jsxs("td",{colSpan:"9",className:"fw-bold",children:["Invoice ID: ",t]})}),a.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:s.supplier}),e.jsxs("td",{children:[s.size," ",s.size_unit]}),e.jsxs("td",{className:"text-center",children:[s.weight," ",s.weight_unit]}),e.jsx("td",{className:"text-center",children:s.total_product}),e.jsx("td",{className:"text-center",children:s.arrival_depo}),e.jsx("td",{className:"text-center",children:s.on_transit}),e.jsx("td",{colSpan:"2",children:e.jsxs("div",{className:"cart-counting d-flex gap-2",children:[e.jsxs("div",{className:"cart-counting-inc d-flex gap-2 align-items-center",children:[e.jsx("button",{onClick:()=>_(s.final_inventory_id),className:"border-0",children:"-"}),e.jsx("p",{className:"counting",children:m[s.final_inventory_id]||1}),e.jsx("button",{onClick:()=>N(s.final_inventory_id,s.total_product),className:"border-0",children:"+"})]}),e.jsx("div",{className:"cart-counting-btn",children:e.jsx("button",{onClick:()=>v(s),className:"rounded-2 border-0 common_btn",children:"Add to cart"})})]})}),e.jsx("td",{children:e.jsxs("div",{className:"action-btn d-flex gap-2",children:[e.jsx("button",{onClick:()=>b(s.final_inventory_id),className:"border-0",children:e.jsx("i",{className:"fa-solid fa-trash"})}),s.arrival_depo===(l==null?void 0:l.name)?e.jsx("span",{className:"badge-main-port",children:"In Main Port"}):e.jsx("button",{onClick:()=>S(s.final_inventory_id),className:"border-0 text-success",title:"Send to Main Port",children:e.jsx("i",{className:"fa-solid fa-arrow-right-arrow-left"})})]})})]},s.final_inventory_id))]},t))})]})})]})]})}export{Q as default};
